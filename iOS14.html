<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VuePress</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/blog/assets/css/0.styles.6238c46d.css" as="style"><link rel="preload" href="/blog/assets/js/app.f55c660b.js" as="script"><link rel="preload" href="/blog/assets/js/2.29d03ae9.js" as="script"><link rel="preload" href="/blog/assets/js/12.a3964ea6.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.58272c2d.js"><link rel="prefetch" href="/blog/assets/js/11.1ab9b453.js"><link rel="prefetch" href="/blog/assets/js/13.d78c8c27.js"><link rel="prefetch" href="/blog/assets/js/14.05b022ea.js"><link rel="prefetch" href="/blog/assets/js/15.f189049c.js"><link rel="prefetch" href="/blog/assets/js/16.c26f92e7.js"><link rel="prefetch" href="/blog/assets/js/3.0277475e.js"><link rel="prefetch" href="/blog/assets/js/4.09fd2c39.js"><link rel="prefetch" href="/blog/assets/js/5.fc791712.js"><link rel="prefetch" href="/blog/assets/js/6.ffe6f60a.js"><link rel="prefetch" href="/blog/assets/js/7.4fdbd30f.js"><link rel="prefetch" href="/blog/assets/js/8.7c1fbd26.js"><link rel="prefetch" href="/blog/assets/js/9.4c7a00f9.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.6238c46d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar no-sidebar"><!----> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><center><font face="黑体" size="5">iOS14 隐私适配及部分解决方案</font></center> <h4 id="在6月份刚结束的首次线上-wwdc-2020-发布会上苹果向我们展示了新的-ios14-系统。ios14-的适配-很重要的一环就集中在用户隐私和安全方面。"><a href="#在6月份刚结束的首次线上-wwdc-2020-发布会上苹果向我们展示了新的-ios14-系统。ios14-的适配-很重要的一环就集中在用户隐私和安全方面。" class="header-anchor">#</a> 在6月份刚结束的首次线上 WWDC 2020 发布会上苹果向我们展示了新的 iOS14 系统。iOS14 的适配，很重要的一环就集中在用户隐私和安全方面。</h4> <h4 id="在-ios13-及以前-当用户首次访问应用程序时-会被要求开放大量权限-比如相册、定位、联系人-实际上该应用可能仅仅需要一个选择图片功能-却被要求开放整个照片库的权限-这确实是不合理的。对于相册-在-ios14-中引入了-limitedphotos-library-的概念-用户可以授予应用访问其一部分的照片-对于应用来说-仅能读取到用户选择让应用来读取的照片-让我们看到了-apple-对于用户隐私的尊重。这仅仅是一部分-在ios14-中-可以看到诸多类似的保护用户隐私的措施-也需要我们升级适配。"><a href="#在-ios13-及以前-当用户首次访问应用程序时-会被要求开放大量权限-比如相册、定位、联系人-实际上该应用可能仅仅需要一个选择图片功能-却被要求开放整个照片库的权限-这确实是不合理的。对于相册-在-ios14-中引入了-limitedphotos-library-的概念-用户可以授予应用访问其一部分的照片-对于应用来说-仅能读取到用户选择让应用来读取的照片-让我们看到了-apple-对于用户隐私的尊重。这仅仅是一部分-在ios14-中-可以看到诸多类似的保护用户隐私的措施-也需要我们升级适配。" class="header-anchor">#</a> 在 iOS13 及以前，当用户首次访问应用程序时，会被要求开放大量权限，比如相册、定位、联系人，实际上该应用可能仅仅需要一个选择图片功能，却被要求开放整个照片库的权限，这确实是不合理的。对于相册，在 iOS14 中引入了 “LimitedPhotos Library” 的概念，用户可以授予应用访问其一部分的照片，对于应用来说，仅能读取到用户选择让应用来读取的照片，让我们看到了 Apple 对于用户隐私的尊重。这仅仅是一部分，在iOS14 中，可以看到诸多类似的保护用户隐私的措施，也需要我们升级适配。</h4> <h4 id="-ios14-新增了-limited-photo-library-access-模式-在授权弹窗中增加了-select-photo-选项。用户可以在-app-请求调用相册时选择部分照片让-app-读取。从-app-的视⻆来看-你的相册里就只有这几张照片-app-无法得知其它照片的存在。"><a href="#-ios14-新增了-limited-photo-library-access-模式-在授权弹窗中增加了-select-photo-选项。用户可以在-app-请求调用相册时选择部分照片让-app-读取。从-app-的视⻆来看-你的相册里就只有这几张照片-app-无法得知其它照片的存在。" class="header-anchor">#</a>  iOS14 新增了“Limited Photo Library Access” 模式，在授权弹窗中增加了 Select Photo 选项。用户可以在 App 请求调用相册时选择部分照片让 App 读取。从 App 的视⻆来看，你的相册里就只有这几张照片，App 无法得知其它照片的存在。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/vOQwVvIqDUz4dNhJKHzIJzA.png" alt="session"></p> <h4 id="-ios14-中当用户选择"><a href="#-ios14-中当用户选择" class="header-anchor">#</a>  iOS14 中当用户选择</h4> <h4 id="phauthorizationstatuslimited-时-如果未进行适配-有可能会在每次触发相册功能时都进行弹窗询问用户是否需要修改照片权限。"><a href="#phauthorizationstatuslimited-时-如果未进行适配-有可能会在每次触发相册功能时都进行弹窗询问用户是否需要修改照片权限。" class="header-anchor">#</a> “PHAuthorizationStatusLimited” 时，如果未进行适配，有可能会在每次触发相册功能时都进行弹窗询问用户是否需要修改照片权限。</h4> <h4 id="-对于这种情况可通过在-info-plist-中设置"><a href="#-对于这种情况可通过在-info-plist-中设置" class="header-anchor">#</a>  对于这种情况可通过在 Info.plist 中设置</h4> <h4 id="phphotolibrarypreventautomaticlimitedaccessalert-的值为-yes-来阻止该弹窗反复弹出-并且可通过下面这个-api-来主动控制何时弹出phpickerviewcontroller-进行照片选择"><a href="#phphotolibrarypreventautomaticlimitedaccessalert-的值为-yes-来阻止该弹窗反复弹出-并且可通过下面这个-api-来主动控制何时弹出phpickerviewcontroller-进行照片选择" class="header-anchor">#</a> “PHPhotoLibraryPreventAutomaticLimitedAccessAlert”的值为 YES 来阻止该弹窗反复弹出，并且可通过下面这个 API 来主动控制何时弹出PHPickerViewController 进行照片选择</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token punctuation">[</span>PHPhotoLibrary sharedPhotoLibrary<span class="token punctuation">]</span> presentLimitedLibraryPickerFromViewController<span class="token operator">:</span>self<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="-在-ios14-中官方推荐使用-phpicker-来替代原-api-进行图片选择。phpicker-为独立进程-会在视图最顶层进行展示-应用内无法对其进行截图也无法直接访问到其内的数据。"><a href="#-在-ios14-中官方推荐使用-phpicker-来替代原-api-进行图片选择。phpicker-为独立进程-会在视图最顶层进行展示-应用内无法对其进行截图也无法直接访问到其内的数据。" class="header-anchor">#</a>  在 iOS14 中官方推荐使用 PHPicker 来替代原 API 进行图片选择。PHPicker 为独立进程，会在视图最顶层进行展示，应用内无法对其进行截图也无法直接访问到其内的数据。</h4> <h4 id="uiimagepickercontroller-phpickerviewcontroller-uiimagepickerviewcontroller-功能受限-每次只能选择一张图片-将逐渐被废弃。"><a href="#uiimagepickercontroller-phpickerviewcontroller-uiimagepickerviewcontroller-功能受限-每次只能选择一张图片-将逐渐被废弃。" class="header-anchor">#</a> UIImagePickerController -&gt; PHPickerViewController， UIImagePickerViewController 功能受限，每次只能选择一张图片，将逐渐被废弃。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/YLkCktGUVwVtIC80j6TCNFE.png" alt="session"></p> <h4 id="phpicker-支持多选-支持搜索-支持按-image-video-livephotos-等进行选择。"><a href="#phpicker-支持多选-支持搜索-支持按-image-video-livephotos-等进行选择。" class="header-anchor">#</a> PHPicker 支持多选，支持搜索，支持按 image，video，livePhotos 等进行选择。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/CKdegxLZfFY97Ly06DK2NCD.png" alt="session"></p> <h2 id="-新api及迁移demo"><a href="#-新api及迁移demo" class="header-anchor">#</a>  新API及迁移demo:</h2> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/fqahFgD3oGewCDJNPszjQtD.png" alt="session"></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>@<span class="token keyword">interface</span> <span class="token class-name">ViewController</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span>PHPickerViewControllerDelegate<span class="token operator">&gt;</span>
  
@<span class="token function">property</span> <span class="token punctuation">(</span>weak<span class="token punctuation">,</span> nonatomic<span class="token punctuation">)</span> IBOutlet UIImageView <span class="token operator">*</span>imageView<span class="token punctuation">;</span>
@<span class="token function">property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> strong<span class="token punctuation">)</span> NSArray<span class="token operator">&lt;</span>NSItemProvider <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span>itemProviders<span class="token punctuation">;</span>
  
@end
  
@implementation ViewController
  
  <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidLoad <span class="token punctuation">{</span>
      <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidLoad<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// Do any additional setup after loading the view.</span>
<span class="token punctuation">}</span>
  
  <span class="token operator">-</span> <span class="token punctuation">(</span>IBAction<span class="token punctuation">)</span>button<span class="token operator">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender <span class="token punctuation">{</span>
      <span class="token comment">// 以下 API 仅为 iOS14 only</span>
      PHPickerConfiguration <span class="token operator">*</span>configuration <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>PHPickerConfiguration alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
      configuration<span class="token punctuation">.</span>filter <span class="token operator">=</span> <span class="token punctuation">[</span>PHPickerFilter videosFilter<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 可配置查询用户相册中文件的类型，支持三种</span>
    configuration<span class="token punctuation">.</span>selectionLimit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 默认为1，为0时表示可多选。</span>
  
      PHPickerViewController <span class="token operator">*</span>picker <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>PHPickerViewController alloc<span class="token punctuation">]</span> initWithConfiguration<span class="token operator">:</span>configuration<span class="token punctuation">]</span><span class="token punctuation">;</span>
      picker<span class="token punctuation">.</span>delegate <span class="token operator">=</span> self<span class="token punctuation">;</span>
      <span class="token comment">// picker vc，在选完图片后需要在回调中手动 dismiss</span>
    <span class="token punctuation">[</span>self presentViewController<span class="token operator">:</span>picker animated<span class="token operator">:</span><span class="token constant">YES</span> completion<span class="token operator">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
  
      <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
#pragma mark <span class="token operator">-</span> Delegate
  
  <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>picker<span class="token operator">:</span><span class="token punctuation">(</span>PHPickerViewController <span class="token operator">*</span><span class="token punctuation">)</span>picker didFinishPicking<span class="token operator">:</span><span class="token punctuation">(</span>NSArray<span class="token operator">&lt;</span>PHPickerResult <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span>results <span class="token punctuation">{</span>
      <span class="token punctuation">[</span>picker dismissViewControllerAnimated<span class="token operator">:</span><span class="token constant">YES</span> completion<span class="token operator">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>results <span class="token operator">||</span> <span class="token operator">!</span>results<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      NSItemProvider <span class="token operator">*</span>itemProvider <span class="token operator">=</span> results<span class="token punctuation">.</span>firstObject<span class="token punctuation">.</span>itemProvider<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>itemProvider canLoadObjectOfClass<span class="token operator">:</span>UIImage<span class="token punctuation">.</span>class<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          __weak <span class="token keyword">typeof</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> weakSelf <span class="token operator">=</span> self<span class="token punctuation">;</span>
          <span class="token punctuation">[</span>itemProvider loadObjectOfClass<span class="token operator">:</span>UIImage<span class="token punctuation">.</span>class <span class="token class-name">completionHandler</span><span class="token operator">:</span><span class="token operator">^</span><span class="token punctuation">(</span>__kindof id<span class="token operator">&lt;</span>NSItemProviderReading<span class="token operator">&gt;</span>  _Nullable object<span class="token punctuation">,</span> NSError <span class="token operator">*</span> _Nullable error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>object isKindOfClass<span class="token operator">:</span>UIImage<span class="token punctuation">.</span>class<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  __strong <span class="token keyword">typeof</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> strongSelf <span class="token operator">=</span> weakSelf<span class="token punctuation">;</span>
                  <span class="token function">dispatch_async</span><span class="token punctuation">(</span><span class="token function">dispatch_get_main_queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">^</span><span class="token punctuation">{</span>
                      strongSelf<span class="token punctuation">.</span>imageView<span class="token punctuation">.</span>image <span class="token operator">=</span> <span class="token punctuation">(</span>UIImage <span class="token operator">*</span><span class="token punctuation">)</span>object<span class="token punctuation">;</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h4 id="-需要注意的是-在-limit-photo-模式下-assetslibrary-访问相册会失败-在-writeonly-模式下-assetlibrary-也会有显示问题。建议还在使用-assetslibrary-的同学尽快迁移到新-api。"><a href="#-需要注意的是-在-limit-photo-模式下-assetslibrary-访问相册会失败-在-writeonly-模式下-assetlibrary-也会有显示问题。建议还在使用-assetslibrary-的同学尽快迁移到新-api。" class="header-anchor">#</a>  需要注意的是，在 limit Photo 模式下，AssetsLibrary 访问相册会失败；在 writeOnly 模式下，AssetLibrary 也会有显示问题。建议还在使用 AssetsLibrary 的同学尽快迁移到新 API。</h4> <h4 id="-授权相关-旧-api-废弃-增加-phaccesslevel-参数。如果再使用以前的api来获取权限状态"><a href="#-授权相关-旧-api-废弃-增加-phaccesslevel-参数。如果再使用以前的api来获取权限状态" class="header-anchor">#</a>  授权相关：旧 API 废弃，增加 PHAccessLevel 参数。如果再使用以前的API来获取权限状态，</h4> <h4 id="phauthorizationstatuslimited-状态下也会返回"><a href="#phauthorizationstatuslimited-状态下也会返回" class="header-anchor">#</a> PHAuthorizationStatusLimited 状态下也会返回</h4> <h4 id="phauthorizationstatusauthorized"><a href="#phauthorizationstatusauthorized" class="header-anchor">#</a> PHAuthorizationStatusAuthorized</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/iz1r0THyDquGwJr6XSp1KRD.png" alt="session"></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>typedef <span class="token constant">NS_ENUM</span><span class="token punctuation">(</span><span class="token parameter">NSInteger<span class="token punctuation">,</span> PHAccessLevel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  PHAccessLevelAddOnly <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 仅允许添加照片</span>
  PHAccessLevelReadWrite <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 允许访问照片，limitedLevel 必须为 readWrite</span>
<span class="token punctuation">}</span> <span class="token constant">API_AVAILABLE</span><span class="token punctuation">(</span><span class="token function">macos</span><span class="token punctuation">(</span><span class="token number">10.16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ios</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">tvos</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 查询权限</span>
PHAccessLevel level <span class="token operator">=</span> PHAccessLevelReadWrite<span class="token punctuation">;</span>
PHAuthorizationStatus status <span class="token operator">=</span> <span class="token punctuation">[</span>PHPhotoLibrary authorizationStatusForAccessLevel<span class="token operator">:</span>level<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> PHAuthorizationStatusLimited<span class="token operator">:</span>
          <span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;limited&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> PHAuthorizationStatusDenied<span class="token operator">:</span>
          <span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;denied&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> PHAuthorizationStatusAuthorized<span class="token operator">:</span>
          <span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;authorized&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 请求权限，需注意 limited 权限尽在 accessLevel 为 readAndWrite 时生效</span>
<span class="token punctuation">[</span>PHPhotoLibrary requestAuthorizationForAccessLevel<span class="token operator">:</span>level handler<span class="token operator">:</span><span class="token operator">^</span><span class="token punctuation">(</span>PHAuthorizationStatus status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> PHAuthorizationStatusLimited<span class="token operator">:</span>
          <span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;limited&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> PHAuthorizationStatusDenied<span class="token operator">:</span>
          <span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;denied&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> PHAuthorizationStatusAuthorized<span class="token operator">:</span>
          <span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;authorized&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="▐-定位"><a href="#▐-定位" class="header-anchor">#</a> ▐ 定位</h2> <h4 id="-在-ios13-及以前-app-请求用户定位授权时为如下形态-一旦用户同意应用获取定位信息-当前应用就可以获取到用户的精确定位。"><a href="#-在-ios13-及以前-app-请求用户定位授权时为如下形态-一旦用户同意应用获取定位信息-当前应用就可以获取到用户的精确定位。" class="header-anchor">#</a>  在 iOS13 及以前，App 请求用户定位授权时为如下形态：一旦用户同意应用获取定位信息，当前应用就可以获取到用户的精确定位。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/koTwYnJePGGMYFzK6UrDOqC.png" alt="session"></p> <h4 id="-ios14-新增用户大致位置选项可供用户选择-原因是大多数-app-实际上并不需要获取用户到用户最准确的定位信息。ios14-授权弹窗新增的-precise的开关默认会选中精确位置。用户通过这个开关可以进行更改-当把这个值设为-on-时-地图上会显示精确位置-切换为off时-将显示用户的大致位置。"><a href="#-ios14-新增用户大致位置选项可供用户选择-原因是大多数-app-实际上并不需要获取用户到用户最准确的定位信息。ios14-授权弹窗新增的-precise的开关默认会选中精确位置。用户通过这个开关可以进行更改-当把这个值设为-on-时-地图上会显示精确位置-切换为off时-将显示用户的大致位置。" class="header-anchor">#</a>  iOS14 新增用户大致位置选项可供用户选择，原因是大多数 App 实际上并不需要获取用户到用户最准确的定位信息。iOS14 授权弹窗新增的 Precise的开关默认会选中精确位置。用户通过这个开关可以进行更改，当把这个值设为 On 时，地图上会显示精确位置；切换为Off时，将显示用户的大致位置。</h4> <h4 id="-对于对用户位置敏感度不高的-app-来说-这个似乎无影响-但是对于强依赖精确位置的-app-适配工作就显得非常重要了。可以通过用户在-隐私设置-中设置来开启精确定位-但是可能用户宁可放弃使用这个应用也不愿意开启。这个时候-ios14-在-cllocationmanager-新增两个方法可用于向用户申请临时开启一次精确位置权限。"><a href="#-对于对用户位置敏感度不高的-app-来说-这个似乎无影响-但是对于强依赖精确位置的-app-适配工作就显得非常重要了。可以通过用户在-隐私设置-中设置来开启精确定位-但是可能用户宁可放弃使用这个应用也不愿意开启。这个时候-ios14-在-cllocationmanager-新增两个方法可用于向用户申请临时开启一次精确位置权限。" class="header-anchor">#</a>  对于对用户位置敏感度不高的 App 来说，这个似乎无影响，但是对于强依赖精确位置的 App 适配工作就显得非常重要了。可以通过用户在 “隐私设置” 中设置来开启精确定位，但是可能用户宁可放弃使用这个应用也不愿意开启。这个时候，iOS14 在 CLLocationManager 新增两个方法可用于向用户申请临时开启一次精确位置权限。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/0JoXFZHsV4GunRH6C4ynIuA.png" alt="session"></p> <h4 id="使用方式也很简单-需要首先在-info-plist-中配置-nslocationtemporaryusagedescriptiondictionary-字典中需要配置-key-和-value-表明使用位置的原因-以及具体的描述。"><a href="#使用方式也很简单-需要首先在-info-plist-中配置-nslocationtemporaryusagedescriptiondictionary-字典中需要配置-key-和-value-表明使用位置的原因-以及具体的描述。" class="header-anchor">#</a> 使用方式也很简单，需要首先在 Info.plist 中配置“NSLocationTemporaryUsageDescriptionDictionary”字典中需要配置 key 和 value 表明使用位置的原因，以及具体的描述。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/4OO69BSKRkxIATHZ1HreHzC.png" alt="session"></p> <h4 id="在本例中-key-即为获取用户权限时传的-purposekey-最终呈现给用户的就是左图-右图为当app主动关闭精确定位权限申请。"><a href="#在本例中-key-即为获取用户权限时传的-purposekey-最终呈现给用户的就是左图-右图为当app主动关闭精确定位权限申请。" class="header-anchor">#</a> 在本例中，key 即为获取用户权限时传的 &quot;purposeKey&quot;，最终呈现给用户的就是左图，右图为当App主动关闭精确定位权限申请。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/kc6m3bPlQSZtqOBBLsWdIrD.png" alt="session"></p> <h4 id="-对于地理位置不敏感的app-来说-ios14-也可以通过直接在-info-plist-中添加-nslocationdefaultaccuracyreduced-为-true-默认请求大概位置。"><a href="#-对于地理位置不敏感的app-来说-ios14-也可以通过直接在-info-plist-中添加-nslocationdefaultaccuracyreduced-为-true-默认请求大概位置。" class="header-anchor">#</a>  对于地理位置不敏感的App 来说，iOS14 也可以通过直接在 info.plist 中添加 NSLocationDefaultAccuracyReduced 为 true 默认请求大概位置。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/bCF1U8H3CnOCuLp2chuxCMB.png" alt="session"></p> <h4 id="-这样设置之后-即使用户想要为该-app-开启精确定位权限-也无法开启。"><a href="#-这样设置之后-即使用户想要为该-app-开启精确定位权限-也无法开启。" class="header-anchor">#</a>  这样设置之后，即使用户想要为该 App 开启精确定位权限，也无法开启。</h4> <h4 id="-也可以直接通过api来根据不同的需求设置不同的定位精确度。"><a href="#-也可以直接通过api来根据不同的需求设置不同的定位精确度。" class="header-anchor">#</a>  也可以直接通过API来根据不同的需求设置不同的定位精确度。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/HMHLMjSK6TJYFFPNgyLxF6A.png" alt="session"></p> <h4 id="-需要注意的是-当-app-在-background-模式下-如果并未获得精确位置授权-那么-beacon-及其他位置敏感功能都将受到限制。"><a href="#-需要注意的是-当-app-在-background-模式下-如果并未获得精确位置授权-那么-beacon-及其他位置敏感功能都将受到限制。" class="header-anchor">#</a>  需要注意的是，当 App 在 Background 模式下，如果并未获得精确位置授权，那么 Beacon 及其他位置敏感功能都将受到限制。</h4> <h4 id="▐-local-network"><a href="#▐-local-network" class="header-anchor">#</a> ▐ Local Network</h4> <h4 id="-ios14-当-app-要使用-bonjour-服务时或者访问本地局域网-使用-mdns-服务等-都需要授权-开发者需要在-info-plist-中详细描述使用的为哪种服务以及用途。下图为需要无需申请权限与需要授权的服务"><a href="#-ios14-当-app-要使用-bonjour-服务时或者访问本地局域网-使用-mdns-服务等-都需要授权-开发者需要在-info-plist-中详细描述使用的为哪种服务以及用途。下图为需要无需申请权限与需要授权的服务" class="header-anchor">#</a>  iOS14 当 App 要使用 Bonjour 服务时或者访问本地局域网，使用 mDNS 服务等，都需要授权，开发者需要在 Info.plist 中详细描述使用的为哪种服务以及用途。下图为需要无需申请权限与需要授权的服务：</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/ddPZ6qGAIldgaQVgA4KYEYC.png" alt="session"></p> <h4 id="-在-隐私设置-中也可以查看和修改具体有哪些-app-正在使用-localnetwork"><a href="#-在-隐私设置-中也可以查看和修改具体有哪些-app-正在使用-localnetwork" class="header-anchor">#</a>  在 &quot;隐私设置&quot; 中也可以查看和修改具体有哪些 App 正在使用 LocalNetwork</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/hB8ULKOi7iodqKOTK5cvKpA.png" alt="session"></p> <h4 id="-如果应用中需要使用-localnetwork-需要在-info-plist-中配置两个选项-详细描述为什么需要使用该权限-以及需要列出具体使用-localnetwork-的服务列表。"><a href="#-如果应用中需要使用-localnetwork-需要在-info-plist-中配置两个选项-详细描述为什么需要使用该权限-以及需要列出具体使用-localnetwork-的服务列表。" class="header-anchor">#</a>  如果应用中需要使用 LocalNetwork 需要在 Info.plist 中配置两个选项，详细描述为什么需要使用该权限，以及需要列出具体使用 LocalNetwork 的服务列表。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/YlRY0yDewayb4KSO6AmjLAA.png" alt="session"></p> <h4 id="-对于使用了下列包含-bonjour-的-framework-都需要更新描述"><a href="#-对于使用了下列包含-bonjour-的-framework-都需要更新描述" class="header-anchor">#</a>  对于使用了下列包含 Bonjour 的 framework，都需要更新描述.</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/CmR4koBs5VxhrJbdIH9COEC.png" alt="session"></p> <h4 id="▐-wi-fi-address"><a href="#▐-wi-fi-address" class="header-anchor">#</a> ▐ Wi-Fi Address</h4> <h3 id="-ios8-ios13-用户在不同的网络间切换和接入时-mac-地址都不会改变-这也就使得网络运营商还是可以通过-mac-地址对用户进行匹配和用户信息收集-生成完整的用户信息。ios14-提供-wifi-加密服务-每次接入不同的-wifi-使用的-mac-地址都不同。每过-24-小时-mac-地址还会更新一次。需要关注是否有使用用户网络-mac-地址的服务。"><a href="#-ios8-ios13-用户在不同的网络间切换和接入时-mac-地址都不会改变-这也就使得网络运营商还是可以通过-mac-地址对用户进行匹配和用户信息收集-生成完整的用户信息。ios14-提供-wifi-加密服务-每次接入不同的-wifi-使用的-mac-地址都不同。每过-24-小时-mac-地址还会更新一次。需要关注是否有使用用户网络-mac-地址的服务。" class="header-anchor">#</a>  iOS8 - iOS13 ，用户在不同的网络间切换和接入时，mac 地址都不会改变，这也就使得网络运营商还是可以通过 mac 地址对用户进行匹配和用户信息收集，生成完整的用户信息。iOS14 提供 Wifi 加密服务，每次接入不同的 WiFi 使用的 mac 地址都不同。每过 24 小时，mac 地址还会更新一次。需要关注是否有使用用户网络 mac 地址的服务。</h3> <h4 id="-下图为-ios13-及之前用户接入网络时-mac-地址并不会进行改变"><a href="#-下图为-ios13-及之前用户接入网络时-mac-地址并不会进行改变" class="header-anchor">#</a>  下图为 iOS13 及之前用户接入网络时 mac 地址并不会进行改变</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/rigyk7NK5GgPdSAO4lcjJFA.png" alt="session"></p> <h4 id="-下图为-ios14-用户接入-wi-fi-时-mac-地址的变化情况"><a href="#-下图为-ios14-用户接入-wi-fi-时-mac-地址的变化情况" class="header-anchor">#</a>  下图为 iOS14 用户接入 Wi-Fi 时 mac 地址的变化情况</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/5mNnacKOSd3sDLoyajAgCCC.png" alt="session"></p> <h4 id="-并且用户也可以自行选择是否开启-private-wi-fi-address"><a href="#-并且用户也可以自行选择是否开启-private-wi-fi-address" class="header-anchor">#</a>  并且用户也可以自行选择是否开启 private Wi-Fi address</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/gAyuL2OjjZfpNPOzcm85HtD.png" alt="session"></p> <h2 id="▐-剪切板"><a href="#▐-剪切板" class="header-anchor">#</a> ▐ 剪切板</h2> <h4 id="-在-ios14-中-读取用户剪切板的数据会弹出提示。"><a href="#-在-ios14-中-读取用户剪切板的数据会弹出提示。" class="header-anchor">#</a>  在 iOS14 中，读取用户剪切板的数据会弹出提示。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/3jJGBUBtmSuFXPHHwJNSLjA.png" alt="session"></p> <h4 id="-弹出提示的原因是使用-uipasteboard-访问用户数据-访问以下数据都会弹出-toast-提示。"><a href="#-弹出提示的原因是使用-uipasteboard-访问用户数据-访问以下数据都会弹出-toast-提示。" class="header-anchor">#</a>  弹出提示的原因是使用 UIPasteboard 访问用户数据，访问以下数据都会弹出 toast 提示。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/wj19pzEomlN0STCudmgzM8D.png" alt="session"></p> <h4 id="-兼容方案-如果应用访问剪切板仅仅用于判断是否为url格式-则-ios14-新增了两个-api-可以用于规避该提示。如果应用想直接访问剪切板的数据-暂时可能无法做到规避该提示。ios14-新增两种"><a href="#-兼容方案-如果应用访问剪切板仅仅用于判断是否为url格式-则-ios14-新增了两个-api-可以用于规避该提示。如果应用想直接访问剪切板的数据-暂时可能无法做到规避该提示。ios14-新增两种" class="header-anchor">#</a>  兼容方案：如果应用访问剪切板仅仅用于判断是否为URL格式，则 iOS14 新增了两个 API 可以用于规避该提示。如果应用想直接访问剪切板的数据，暂时可能无法做到规避该提示。iOS14 新增两种</h4> <h4 id="uipasteboarddetectionpattern。"><a href="#uipasteboarddetectionpattern。" class="header-anchor">#</a> UIPasteboardDetectionPattern。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/3h3kA5Bbs6AumSQGPz6GF7C.png" alt="session"></p> <h4 id="-上面的两个-api-可用于规避提示-但只能用于判断剪切板中是否有-url-并不是真正的访问剪贴板数据-也拿不到剪切板的真实数据。下面两个-api-可以获得具体的-url-信息-但是会触发剪切板提示。并且实测当用户剪切板中包含多个-url-时只会返回第一个。"><a href="#-上面的两个-api-可用于规避提示-但只能用于判断剪切板中是否有-url-并不是真正的访问剪贴板数据-也拿不到剪切板的真实数据。下面两个-api-可以获得具体的-url-信息-但是会触发剪切板提示。并且实测当用户剪切板中包含多个-url-时只会返回第一个。" class="header-anchor">#</a>  上面的两个 API 可用于规避提示，但只能用于判断剪切板中是否有 URL，并不是真正的访问剪贴板数据，也拿不到剪切板的真实数据。下面两个 API 可以获得具体的 URL 信息，但是会触发剪切板提示。并且实测当用户剪切板中包含多个 URL 时只会返回第一个。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/ABXomgSPoR9CfDZmh6vKKxC.png" alt="session"></p> <h4 id="-使用示例"><a href="#-使用示例" class="header-anchor">#</a>  使用示例</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
NSSet <span class="token operator">*</span>patterns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSSet alloc<span class="token punctuation">]</span> initWithObjects<span class="token operator">:</span>UIPasteboardDetectionPatternProbableWebURL<span class="token punctuation">,</span> nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span>UIPasteboard generalPasteboard<span class="token punctuation">]</span> detectPatternsForPatterns<span class="token operator">:</span>patterns completionHandler<span class="token operator">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSSet<span class="token operator">&lt;</span>UIPasteboardDetectionPattern<span class="token operator">&gt;</span> <span class="token operator">*</span> _Nullable result<span class="token punctuation">,</span> NSError <span class="token operator">*</span> _Nullable error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 当前剪切板中存在 URL</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="▐-相机和麦克风"><a href="#▐-相机和麦克风" class="header-anchor">#</a> ▐ 相机和麦克风</h2> <h4 id="-ios14-中-app-使用相机和麦克风时会有图标提示以及绿点和黄点提示-并且会显示当前是哪个-app-在使用此功能。我们无法控制是否显示该提示。"><a href="#-ios14-中-app-使用相机和麦克风时会有图标提示以及绿点和黄点提示-并且会显示当前是哪个-app-在使用此功能。我们无法控制是否显示该提示。" class="header-anchor">#</a>  iOS14 中 App 使用相机和麦克风时会有图标提示以及绿点和黄点提示，并且会显示当前是哪个 App 在使用此功能。我们无法控制是否显示该提示。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/bQV00CKariVMnNAGE8K5LMB.png" alt="session"></p> <h4 id="-会触发录音小黄点的代码示例"><a href="#-会触发录音小黄点的代码示例" class="header-anchor">#</a>  会触发录音小黄点的代码示例：</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>AVAudioRecorder <span class="token operator">*</span>recorder <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>AVAudioRecorder alloc<span class="token punctuation">]</span> initWithURL<span class="token operator">:</span>recorderPath settings<span class="token operator">:</span>nil error<span class="token operator">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>recorder record<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="-触发相机小绿点的代码示例"><a href="#-触发相机小绿点的代码示例" class="header-anchor">#</a>  触发相机小绿点的代码示例:</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
AVCaptureDeviceInput <span class="token operator">*</span>videoInput <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>AVCaptureDeviceInput alloc<span class="token punctuation">]</span> initWithDevice<span class="token operator">:</span>videoCaptureDevice error<span class="token operator">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
AVCaptureSession <span class="token operator">*</span>session <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>AVCaptureSession alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>session canAddInput<span class="token operator">:</span>videoInput<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>session addInput<span class="token operator">:</span>videoInput<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">[</span>session startRunning<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="▐-idfa"><a href="#▐-idfa" class="header-anchor">#</a> ▐ IDFA</h2> <h4 id="-idfa-全称为-identity-for-advertisers-即广告标识符。用来标记用户-目前最广泛的用途是用于投放广告、个性化推荐等。"><a href="#-idfa-全称为-identity-for-advertisers-即广告标识符。用来标记用户-目前最广泛的用途是用于投放广告、个性化推荐等。" class="header-anchor">#</a>  IDFA 全称为 Identity for Advertisers ，即广告标识符。用来标记用户，目前最广泛的用途是用于投放广告、个性化推荐等。</h4> <h4 id="-在-ios13-及以前-系统会默认为用户开启允许追踪设置-我们可以简单的通过代码来获取到用户的-idfa-标识符。"><a href="#-在-ios13-及以前-系统会默认为用户开启允许追踪设置-我们可以简单的通过代码来获取到用户的-idfa-标识符。" class="header-anchor">#</a>  在 iOS13 及以前，系统会默认为用户开启允许追踪设置，我们可以简单的通过代码来获取到用户的 IDFA 标识符。</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>ASIdentifierManager sharedManager<span class="token punctuation">]</span> isAdvertisingTrackingEnabled<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    NSString <span class="token operator">*</span>idfaString <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>ASIdentifierManager sharedManager<span class="token punctuation">]</span> advertisingIdentifier<span class="token punctuation">]</span><span class="token punctuation">.</span>UUIDString<span class="token punctuation">;</span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span>@<span class="token string">&quot;%@&quot;</span><span class="token punctuation">,</span> idfaString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="-但是在-ios14-中-这个判断用户是否允许被追踪的方法已经废弃。"><a href="#-但是在-ios14-中-这个判断用户是否允许被追踪的方法已经废弃。" class="header-anchor">#</a>  但是在 iOS14 中，这个判断用户是否允许被追踪的方法已经废弃。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/n4AZQCJWkZD2RC4hw9GpI9B.png" alt="session"></p> <h4 id="-ios14-中-系统会默认为用户关闭广告追踪权限。"><a href="#-ios14-中-系统会默认为用户关闭广告追踪权限。" class="header-anchor">#</a>  iOS14 中，系统会默认为用户关闭广告追踪权限。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/Pdv8BBRK5fadrJLAEy7mRgB.png" alt="session"></p> <h4 id="-对于这种情况-我们需要去请求用户权限。首先需要在-info-plist-中配置-nsusertrackingusagedescription-及描述文案-接着使用-apptrackingtransparency-框架中的-attrackingmanager-中的-requesttrackingauthorizationwithcompletionhandler-请求用户权限-在用户授权后再去访问-idfa-才能够获取到正确信息。"><a href="#-对于这种情况-我们需要去请求用户权限。首先需要在-info-plist-中配置-nsusertrackingusagedescription-及描述文案-接着使用-apptrackingtransparency-框架中的-attrackingmanager-中的-requesttrackingauthorizationwithcompletionhandler-请求用户权限-在用户授权后再去访问-idfa-才能够获取到正确信息。" class="header-anchor">#</a>  对于这种情况，我们需要去请求用户权限。首先需要在 Info.plist 中配置&quot; NSUserTrackingUsageDescription &quot; 及描述文案，接着使用 AppTrackingTransparency 框架中的 ATTrackingManager 中的 requestTrackingAuthorizationWithCompletionHandler 请求用户权限，在用户授权后再去访问 IDFA 才能够获取到正确信息。</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>#<span class="token keyword">import</span> <span class="token operator">&lt;</span>AppTrackingTransparency<span class="token operator">/</span>AppTrackingTransparency<span class="token punctuation">.</span>h<span class="token operator">&gt;</span>
#<span class="token keyword">import</span> <span class="token operator">&lt;</span>AdSupport<span class="token operator">/</span>AdSupport<span class="token punctuation">.</span>h<span class="token operator">&gt;</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>testIDFA <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>@<span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">14</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>ATTrackingManager requestTrackingAuthorizationWithCompletionHandler<span class="token operator">:</span><span class="token operator">^</span><span class="token punctuation">(</span>ATTrackingManagerAuthorizationStatus status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> ATTrackingManagerAuthorizationStatusAuthorized<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                NSString <span class="token operator">*</span>idfaString <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>ASIdentifierManager sharedManager<span class="token punctuation">]</span> advertisingIdentifier<span class="token punctuation">]</span><span class="token punctuation">.</span>UUIDString<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 使用原方式访问 IDFA</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="▐-上传-appstore"><a href="#▐-上传-appstore" class="header-anchor">#</a> ▐ 上传 AppStore</h2> <h4 id="更加严格的隐私审核-可以让用户在下载-app-之前就知道此-app-将会需要哪些权限。目前苹果商店要求所有应用在上架时都必须提供一份隐私政策。如果引入了第三方收集用户信息等sdk-都需要向苹果说明是这些信息的用途。"><a href="#更加严格的隐私审核-可以让用户在下载-app-之前就知道此-app-将会需要哪些权限。目前苹果商店要求所有应用在上架时都必须提供一份隐私政策。如果引入了第三方收集用户信息等sdk-都需要向苹果说明是这些信息的用途。" class="header-anchor">#</a> 更加严格的隐私审核，可以让用户在下载 App 之前就知道此 App 将会需要哪些权限。目前苹果商店要求所有应用在上架时都必须提供一份隐私政策。如果引入了第三方收集用户信息等SDK，都需要向苹果说明是这些信息的用途。</h4> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/1A7Oc2BOBMN9GItcPlCDDYC.png" alt="session"></p> <p><img src="http://lc-0YAfVzoP.cn-n1.lcfile.com/a5vYhHEVU1KAlPQNsvTVRPA.png" alt="session"></p> <h1 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h1> <h4 id="对于这次-ios14-的隐私权限大升级和新尝试-体现了苹果对于用户隐私的尊重。"><a href="#对于这次-ios14-的隐私权限大升级和新尝试-体现了苹果对于用户隐私的尊重。" class="header-anchor">#</a> 对于这次 iOS14 的隐私权限大升级和新尝试，体现了苹果对于用户隐私的尊重。</h4> <h4 id="从用户角度来说-近年来越来越精准的广告投放让我们越来越感觉自己被-监视-着-此次升级后-我们有了更多保护自己隐私的方式以及避免广告骚扰的方法-苹果此举无疑会加大我们对其的好感度和信任感。但从另一个角度来说-对于-idfa-的限制-可能会导致之前许多依靠广告投放收入的免费-app-难以继续维持生计-也可能也会导致免费-app-的数量有所降低。从开发者的角度来说-除了对-ios14-隐私升级的积极适配外-也让我们感受到了-ios14-中对于用户隐私的重视无疑会提高获取用户行为信息的成本。"><a href="#从用户角度来说-近年来越来越精准的广告投放让我们越来越感觉自己被-监视-着-此次升级后-我们有了更多保护自己隐私的方式以及避免广告骚扰的方法-苹果此举无疑会加大我们对其的好感度和信任感。但从另一个角度来说-对于-idfa-的限制-可能会导致之前许多依靠广告投放收入的免费-app-难以继续维持生计-也可能也会导致免费-app-的数量有所降低。从开发者的角度来说-除了对-ios14-隐私升级的积极适配外-也让我们感受到了-ios14-中对于用户隐私的重视无疑会提高获取用户行为信息的成本。" class="header-anchor">#</a> 从用户角度来说，近年来越来越精准的广告投放让我们越来越感觉自己被”监视“着，此次升级后，我们有了更多保护自己隐私的方式以及避免广告骚扰的方法，苹果此举无疑会加大我们对其的好感度和信任感。但从另一个角度来说，对于 IDFA 的限制，可能会导致之前许多依靠广告投放收入的免费 App 难以继续维持生计，也可能也会导致免费 App 的数量有所降低。从开发者的角度来说，除了对 iOS14 隐私升级的积极适配外，也让我们感受到了 iOS14 中对于用户隐私的重视无疑会提高获取用户行为信息的成本。</h4> <h4 id="冲击最大的应该就是广告行业-对于目前的推荐算法和用户拉新都会受到影响-如何在充分尊重用户隐私的前提下进行广告的精准投放对于开发者和广告商来说都是一个不小的机遇和挑战。"><a href="#冲击最大的应该就是广告行业-对于目前的推荐算法和用户拉新都会受到影响-如何在充分尊重用户隐私的前提下进行广告的精准投放对于开发者和广告商来说都是一个不小的机遇和挑战。" class="header-anchor">#</a> 冲击最大的应该就是广告行业，对于目前的推荐算法和用户拉新都会受到影响，如何在充分尊重用户隐私的前提下进行广告的精准投放对于开发者和广告商来说都是一个不小的机遇和挑战。</h4></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.f55c660b.js" defer></script><script src="/blog/assets/js/2.29d03ae9.js" defer></script><script src="/blog/assets/js/12.a3964ea6.js" defer></script>
  </body>
</html>
